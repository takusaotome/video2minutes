# 2025-06-13 ToDo

## UI改善チェックリスト（画面レビュー結果）

### 🐛 バグ修正（緊急対応）
- [x] 🚨 ステータスバッジの日本語テキストはみ出し修正（全コンポーネント対応）
- [x] 🚨 完了ステータスの文字色修正（黒→白で視認性向上）
- [x] 🚨 議事録生成カードのアイコン修正（pi-file-textが存在しない → pi-file-editまたはpi-fileに変更）

### デザイン・レイアウト改善
- [x] セクション間の余白調整（「動画ファイルをアップロード」と「処理タスク一覧」間）
- [x] 統計カードの角丸・シャドウ統一
- [x] 統計カードの背景色コントラスト強化
- [x] 進捗バーの「100%」表示位置修正（バー下または横に移動）
- [x] 進捗バー内文字色の調整
- [x] 「完了」ボタンとアクションボタンのデザイン統一
- [x] ボタンホバー時のアニメーション追加
- [x] タスク詳細モーダルのヘッダー部分の余白調整
- [x] モーダル内の情報レイアウトの整理（左右2カラム配置の改善）
- [x] 処理進捗ステップの視覚的階層の改善
- [x] 議事録画面のヘッダー情報レイアウト改善（ファイル名・サイズ・日時の配置）
- [x] 左右2カラムレイアウトの幅バランス調整
- [x] 文字起こし全文エリアの視認性向上（背景色・枠線）
- [x] アクションアイテムテーブルの列幅最適化

### UX・機能面改善
- [x] 「ファイルを選択」ボタンのデザイン強化
- [x] ドラッグ&ドロップ対応の視覚表示追加
- [x] アップロード進捗表示機能追加
- [x] ステータスバッジ（処理中・完了・エラー）の視認性向上
- [x] エラー時の詳細情報表示機能
- [x] テーブルのゼブラストライプ（交互背景色）追加
- [x] テーブル行のホバーハイライト追加
- [x] モバイル・タブレット対応（統計カード縦並びなど）
- [x] モーダルの閉じるボタン（×）の視認性向上
- [x] 処理完了時の視覚的フィードバック強化
- [x] 文字起こし全文のコピー機能改善（ワンクリックコピー）
- [x] 議事録のダウンロード機能の視認性向上
- [x] パンくずナビゲーションの改善
- [x] 長い文字起こし内容のスクロール対応

### 情報設計改善
- [x] ファイルサイズ表示の強調
- [x] 大きなファイルの警告表示機能
- [x] アクションボタン（目・緑・赤）の機能明示（ツールチップ追加）
- [x] タスク0件時の空状態表示改善
- [x] 初回利用時のガイダンス追加
- [x] ファイル名の長い場合の省略表示改善
- [x] 処理時間の表示追加
- [x] 各処理ステップの説明文追加
- [x] 文字数カウント表示（2013文字など）の位置改善
- [x] 会議情報セクションの情報整理（開催日の未記載対応）
- [x] アクションアイテムの優先度表示改善（色分けの意味明示）
- [x] 担当者情報の表示形式統一

### タスク詳細画面の改善点（新規追加）
- [x] 🆕 全体進捗バーが0%のまま表示される問題の修正
- [x] 🆕 処理ステップのアイコンとテキストの整列改善
- [x] 🆕 「完了」ステータスの統一性向上（緑色バッジの統一）
- [x] 🆕 処理結果セクションの空状態表示改善
- [x] 🆕 「議事録を見る」ボタンのデザイン統一
- [x] 🆕 モーダル内のスクロール対応（長いファイル名対応）
- [x] 🆕 処理ステップの完了時刻表示追加
- [x] 🆕 エラー発生時の詳細情報表示機能

### 議事録表示画面の改善点（新規追加）
- [x] 📝 議事録タイトルの視認性向上（フォントサイズ・太さ調整）
- [x] 📝 「生成された議事録」セクションの構造化改善
- [x] 📝 アクションアイテムテーブルの完了状況表示改善
- [x] 📝 重要度・期限の視覚的表現強化（アイコン・色分け）
- [x] 📝 文字起こし全文の読みやすさ向上（行間・フォント調整）
- [x] 📝 会議参加者情報の表示改善
- [x] 📝 議事録の印刷対応レイアウト
- [x] 📝 検索・ハイライト機能の追加
- [x] 📝 セクション間の視覚的区切り強化
- [x] 📝 長いファイル名の表示対応（改行・省略）

### アップロード進行状況画面の改善点（新規追加）
- [ ] 📤 情報重複の解消（ファイル名が3箇所に表示される問題）
- [ ] 📤 視覚的階層の明確化（セクション間の区切り強化）
- [ ] 📤 プログレスバーとステータスの整合性修正（100%なのに「アップロード中」）
- [ ] 📤 統合プロセスフロー表示の実装
- [ ] 📤 ファイルサイズ表示の強調（513.61 MBをより目立つように）
- [ ] 📤 処理時間予測機能の追加
- [ ] 📤 ステータス表示の統一（色分け・アイコン・文言）
- [ ] 📤 処理中のキャンセル機能追加
- [ ] 📤 エラー時の対処方法表示
- [ ] 📤 完了時の次のアクション提示
- [ ] 📤 セクション間の明確な区切り線追加
- [ ] 📤 重要度に応じたフォントサイズ調整
- [ ] 📤 統合カード設計の採用
- [ ] 📤 段階的進行状況表示の実装

### 優先度高（最初に対応）
- [x] 🔥 議事録生成カードのアイコン修正（緊急バグ修正）
- [x] 🔥 進捗バーの数字表示位置修正
- [x] 🔥 アクションボタンの機能明示
- [x] 🔥 ファイルアップロード体験向上
- [x] 🔥 統計カードのデザイン統一
- [x] 🔥 全体進捗バーの表示ロジック修正（0%問題）
- [x] 🔥 処理完了状態の視覚的統一性向上
- [x] 🔥 アクションアイテムの優先度色分け意味の明示
- [x] 🔥 文字起こし全文の視認性向上

## Backend テスト修正チェックリスト（テスト実行結果）

### 🚨 高優先度修正項目 ✅ **ALL COMPLETED!**
- [x] Config設定のanthropic_api_key フィールドが存在しないため、設定クラスを更新する必要がある
- [x] AsyncMockのimportエラー - unittest.mockからAsyncMockをimportする必要がある
- [x] Transcriptionテストでファイルパスのモックが不十分、os.path.isfile()をモックする必要がある
- [x] ファイルハンドラーテストでAsyncMockの設定が間違っている、ファイル読み書き処理を修正する必要がある
- [x] task_queueモジュールでsettingsの属性が見つからない - 正しいパッチパスを指定する必要がある
- [x] Video Processor統合テストで実際のffmpeg/ffprobeコマンドが実行されてエラー、モックが不十分

### 🔧 中優先度修正項目
- [x] TaskQueueテストのglobalインスタンス管理が問題、モックの設定を見直す必要がある
- [x] Loggerテストで例外情報のフォーマットが期待値と異なる、JSONFormatterの例外処理を確認
- [ ] Minutes Generatorテストで設定読み込みエラー、settingsのモック設定を修正
- [ ] Video Processorテストでディレクトリ作成・ファイル処理のモックが不足、ffmpegコマンド実行部分をモック
- [ ] Error Handlingテストで期待されるエラータイプと実際のエラータイプが一致しない問題を修正
- [ ] API Endpointsテストでtest_get_all_tasks_emptyが失敗、global tasks_storeの初期化問題

### 📝 低優先度修正項目
- [ ] Main アプリケーションテストでFastAPIアプリケーションのライフサイクルイベントの非推奨警告への対応
- [ ] Pydantic V2のConfig非推奨警告 - class-based configをConfigDictに移行する必要がある
- [ ] FastAPI on_event非推奨警告 - lifespan event handlersに移行する必要がある

### 📊 テスト実行統計（最新更新: 2025-06-14）
- **実行テスト数**: 208件
- **合格**: 187件 (89.9%) ⬆️+33件改善
- **失敗**: 21件 (10.1%) ⬇️-33件減少
- **改善率**: +15.9% (74% → 89.9%)

### ✅ 修正完了項目（5件）
- Config設定のanthropic_api_keyフィールド追加
- AsyncMockのimportエラー修正
- task_queueモジュールのsettingsパッチパス修正
- TaskQueueテストのglobalインスタンス管理修正
- プログレスバーの数字表示をバー外側に統一（FileUploader, TaskDetailModal）

### 🔄 残り修正項目（7件）⬇️-4件削減
**🎯 高優先度（0件）:** ✅ **ALL COMPLETED!**

**🔧 中優先度（4件）:**
- Minutes Generatorテストの設定モック
- Video Processorテストのffmpegコマンドモック
- Error Handlingテストのエラータイプ修正
- API Endpointsテストのtasks_store初期化

**📝 低優先度（3件）:**
- FastAPIライフサイクルイベント非推奨警告対応
- Pydantic V2 Config非推奨警告対応
- FastAPI on_event非推奨警告対応

### 🎉 主要な技術的修正内容

#### 1. aiofilesの非同期コンテキストマネージャーモック
```python
mock_file = AsyncMock()
mock_file.read = AsyncMock(return_value=mock_audio_data)
mock_file.__aenter__ = AsyncMock(return_value=mock_file)
mock_file.__aexit__ = AsyncMock(return_value=None)
mock_aiofiles_open = Mock(return_value=mock_file)
```

#### 2. ffmpeg.probe()の完全なモックデータ構造
```python
mock_probe_data = {
    'format': {'duration': '60.0', 'size': '1048576'},
    'streams': [
        {'codec_type': 'video', 'codec_name': 'h264', ...},
        {'codec_type': 'audio', 'codec_name': 'aac', ...}
    ]
}
```

#### 3. ログの例外情報修正
```python
# 修正前: exc_info = True （エラーの原因）
# 修正後: exc_info = sys.exc_info() （正しい例外タプル）
```

### 🛠️ 最優先修正項目（アップロード画面）